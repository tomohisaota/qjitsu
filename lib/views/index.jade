.container
  .row
    .span12
      ul(class="breadcrumb")
        li
          a(href="/")
            span(class="divider") /
        li
          a(href="/#{locals.data.Locale}") #{locals.data.Locale}
        - if(locals.data.Ancestors)
          - for Ancestor in locals.data.Ancestors
            li
              span(class="divider") /
              a(href="/#{locals.data.Locale}/#{Ancestor.NodeId}") #{Ancestor.Name}
        li(class="active")
          span(class="divider") /
          |#{locals.data.Name}
      ul(class="breadcrumb")
        - if(locals.data.Children)
          -for(i=0 ; i < locals.data.Children.length ; i++)
            -var child = locals.data.Children[i]
            li
              -if(i!=0)
                span(class="divider") |
              a(href="/#{locals.data.Locale}/#{child.NodeId}") #{child.Name}
        - else
          li 
            
          
  .loading
    .row
      .span12
        .progress(class="progress-striped active",style="height: 8px;")
          .bar(style="width: 100%;")
      
  .boxes
      

                        
script
  $(function(){
    $(".boxes").hide()
    jQuery.getJSON("/api/#{locals.data.Locale}/#{locals.data.NodeId}",function(items,textStatus) {
      if(textStatus == 'success') {
        jQuery.each(items,function(index,value){
          $box = $("<div/>").addClass("box");
          $link = $("<a/>")
            .attr("class","widelink")
            .attr("href",value.DetailPageURL)
            .attr("target","_blank");
          if(value.Images){
            $link.append($("<img/>")
              .attr("src",value.Images.Medium.URL)
              .attr("width",value.Images.Medium.Width)
              .attr("height",value.Images.Medium.Height)
              );
          }
          else{
            $link.append($("<img/>")
              .attr("src","http://ec1.images-amazon.com/images/G/09/en_JP/nav2/dp/no-image-no-ciu._AA150_.gif")
              .attr("width",150)
              .attr("height",150)
              );
          }
          $link.append($("<div/>").text(value.Title))
          $box.append($link);
          $(".boxes").append($box);
        });
        $('.boxes').imagesLoaded(function(){
          $(".loading").hide()
          $(".boxes").show()
          $('.boxes').masonry({
            itemSelector : '.box'
          });
        });
      }
   });
    $('a[rel=popover]').popover({
      placement : "bottom",
      trigger : "hover"
    });
    $('.dropdown-toggle').dropdown();
    $(document).on('touchstart.dropdown', '.dropdown-menu', function(e) { e.stopPropagation(); });
  });